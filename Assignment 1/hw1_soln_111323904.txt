
 1.1 How many packets does the trace contain?
 Solution: 32664.  
 Command used : tcpdump -nr hw1.pcap | wc -l
 
 1.2 How many ARP packets and how many UDP packets?
 Solution: there are 11304 ARP packets and 18382 UDP packets.
 Command :  tcpdump  arp -nr hw1.pcap | wc -l
           tcpdump  udp -nr hw1.pcap | wc -l
 
 1.3 How many packets were exchanged between 192.168.0.200 and 91.189.90.40?
 Count: 28. 
 Command: tcpdump  "(ip src 192.168.0.200 && ip dst 91.189.90.40) || (ip src 91.189.90.40 && ip dst 192.168.0.200)" -nr hw1.pcap | wc -l
 
 1.4 Print the unique source IP addresses found in the trace. 
 Count : 33
 Result :
	0.0.0.0
	122.154.101.54
	1.234.31.20
	130.75.16.5
	159.148.96.184
	169.254.56.55
	192.168.0.1
	192.168.0.10
	192.168.0.11
	192.168.0.12
	192.168.0.2
	192.168.0.200
	192.168.0.3
	192.168.0.5
	192.168.0.6
	192.168.0.7
	194.168.4.100
	216.137.63.121
	216.137.63.137
	46.51.197.88
	46.51.197.89
	62.252.170.81
	62.252.170.91
	87.230.23.162
	87.98.246.8
	91.189.88.33
	91.189.89.88
	91.189.90.40
	91.189.90.41
	91.189.91.14
	91.189.91.15
	91.189.92.190
	92.240.68.152
	command : tcpdump  ip -nr hw1.pcap | cut -d' ' -f3 | cut -d'.' -f1-4 | sort | uniq	
 
  1.5 Print the unique private network (according to RFC1918) source IP addresses found in the trace.  
 Solution : Privarte network IP fall within -
	10.0.0.0 - 10.255.255.255 (10/8 prefix)
	172.16.0.0 - 172.31.255.255 (172.16/12 prefix)
	192.168.0.0 - 192.168.255.255 (192.168/16 prefix)
	Count : 10
	Result :
	192.168.0.1
	192.168.0.10
	192.168.0.11
	192.168.0.12
	192.168.0.2
	192.168.0.200
	192.168.0.3
	192.168.0.5
	192.168.0.6
	192.168.0.7
 
 command : tcpdump ip  and "(src net 10.0.0.0/8 or src net 172.16.0.0/12 or src net 192.168.0.0/16)" -nr hw1.pcap | cut -d' ' -f3 | cut -d'.' -f1-4 | sort | uniq


 1.6 Print the unique destination IP addresses found in the trace. 
 Count : 31
 The list below shows the unique destination IP address
	122.154.101.54
	1.234.31.20
	130.75.16.5
	159.148.96.184
	169.254.255.255
	192.168.0.12
	192.168.0.200
	192.168.0.255
	194.168.4.100
	216.137.63.121
	216.137.63.137
	224.0.0.22
	224.0.0.251
	224.0.0.252
	224.0.0.253
	239.255.255.250
	255.255.255.255
	46.51.197.88
	46.51.197.89
	62.252.170.81
	62.252.170.91
	87.230.23.162
	87.98.246.8
	91.189.88.33
	91.189.89.88
	91.189.90.40
	91.189.90.41
	91.189.91.14
	91.189.91.15
	91.189.92.190
	92.240.68.152
 Command Used : tcpdump  ip -nr hw1.pcap | cut -d' ' -f5 | cut -d':' -f1 | cut -d'.' -f1-4 | sort | uniq	
 
 1.7 What are the top-5 TCP and top-5 UDP destination ports?
 
 Solution : Top -5 TCP destination ports are : ( formatted as number of usages port number)
   count	Port number
	727 	80
    697 	54634
    346 	49836
     61 	47110
     36 	40341
 
 Command : tcpdump  tcp -nr hw1.pcap | cut -d' ' -f5 | cut -d':' -f1 | cut -d'.' -f5 | sort | uniq -c | sort -nr | head -5
 
 Top -5 UDP destination ports are : ( formatted as number of usages port number)
   count	Port number
	13178 	 1900
	1925 	 137
	1516 	 5355
	840 	 5353
	399 	 138
 
 Command : tcpdump  udp -nr hw1.pcap | cut -d' ' -f5 | cut -d':' -f1 | cut -d'.' -f5 | sort | uniq -c | sort -nr | head -5
 
 1.8 How many TCP packets have the SYN flag set?
 
 Solution : 75
 
 Command : tcpdump  'tcp[tcpflags] & tcp-syn != 0' -nr hw1.pcap | wc -l
 
1.9 How many TCP connection attempts were made?

Solution : 37

Command :  tcpdump 'tcp[tcpflags] == tcp-syn' -nr hw1.pcap | wc -l

1.10 Towards which ports were TCP connection attempts made? How many attempts
     per port?
	 
Solution : The result below shows the count of connection attempts and the port to which the connection attempts where made :
  count 	Port number
	33 		80
    2  		9100
    1  		465
    1  		443

Command : tcpdump  'tcp[tcpflags] == tcp-syn' -nr hw1.pcap | cut -d' ' -f5 | cut -d'.' -f5 | cut -d':' -f1 | sort | uniq -c | sort -nr

1.11 How many HTTP GET requests were made? Print the URLs of all HTTP requests
     for JPG files.	 
	 Count 	 : 94
	 Command : tcpdump -n '(tcp port 80) and (tcp[32:4] = 0x47455420)' -r hw1.pcap | wc -l
	 
	 URLs for JPG files ( count 5)
	 http://pic.leech.it/i/f166c/479246b0asttas.jpg
	 /i/f166c/479246b0asttas.jpg
	 http://ecx.images-amazon.com/images/I/41oZ1XsiOAL._SL500_AA300_.jpg
	 http://www.nature.com/news/2009/090527/images/459492a-i1.0.jpg
	 /news/2009/090527/images/459492a-i1.0.jpg
	
	Command : tcpdump -n '(tcp port 80) and (tcp[32:4] = 0x47455420)' -r hw1.pcap | grep .jpg | cut -d " " -f24
	 
1.12 When (date and time) was the first and last packet of the trace sent?
		First packet Date and time: 2013-01-12 12:37:42.871346
		Command : tcpdump -ntttt -r  hw1.pcap | head -1
		
		Last packet Date and time : 2013-01-14 14:27:03.691498 
		Command : tcpdump -ntttt -r  hw1.pcap | tail -1
		
1.13 What is the brand of the device that sent most of the packets? What is its
     IP address?
	The MAC address of the device was obtained using the below command
	Command : tcpdump -enr hw1.pcap | cut -d' ' -f2 | sort | uniq -c | sort -nr
	Result shows :
  Count :  MAC Address
  19743 c4:3d:c7:17:6f:9b
   4982 00:16:44:b5:86:2e
   4587 44:6d:57:f6:7e:00
    940 3c:d0:f8:4e:4b:a1
    862 00:0c:29:e9:94:8e
    816 34:c0:59:9d:1c:79
    269 00:00:48:46:6c:97
    130 fc:25:3f:8e:4c:9a
    128 e8:8d:28:6d:c8:f5
    101 30:17:c8:3e:4e:82
     69 c4:3d:c7:17:6f:99
     23 c4:3d:c7:17:6f:98
     11 e0:cb:1d:16:13:b2
      3 c4:3d:c7:17:6f:9a
	  
	  From the result it can be seen that the device with the MAC address c4:3d:c7:17:6f:9b sent the largest number of packets.
	  Quering online this MAC address corresponds to the brand NETGEAR
	  
	  IP address for the MAC address c4:3d:c7:17:6f:9b is 192.168.0.1.
	  
	  Actually the MAC address is associated with multiple IP addresses, the one above is the one with the highest count . Other associated IP address are :
	 (192.168.0.1.1901,91.189.91.14.80,91.189.92.190.80,91.189.91.15.80,91.189.88.33.80,194.168.4.100.53,87.98.246.8.80,91.189.90.40.80,194.168.4.100.53 etc)
	
	  Command used : tcpdump -n ether src c4:3d:c7:17:6f:9b -r hw1.pcap | cut -d ' ' -f3| sort| uniq -c| sort -nr| uniq|head -1| cut -d ' ' -f4|cut -d '.' -f1-4
	  
1.14 Report the distribution of Ethernet packet sizes (how many packets of size
     X exist in the trace, for all values of X in the trace).	 
	 
	 Command : tcpdump -ner hw1.pcap | cut -d " " -f9 | cut -d ":" -f1|sort | uniq -c | sort -nr
	 
	 Table below shows the count and the packet size
	 (Total Count : 218)
  Count Packet-size	 
  12190 	60
   2773 	331
   2759 	395
   2758 	405
   2749 	340
   1740 	92
   1046 	66
   1034 	1514
    887 	64
    341 	91
    326 	342
    279 	243
    232 	63
    180 	110
    165 	484
    164 	475
    162 	539
    161 	555
    158 	527
    155 	541
    146 	175
    121 	120
     88 	386
     88 	338
     87 	74
     87 	392
     87 	390
     86 	394
     86 	362
     86 	318
     85 	398
     85 	326
     62 	167
     60 	165
     56 	249
     54 	81
     52 	82
     43 	84
     40 	1033
     39 	219
     36 	231
     33 	460
     32 	602
     28 	119
     24 	42
     24 	315
     22 	698
     22 	246
     17 	551
     17 	202
     16 	245
     15 	302
     15 	127
     14 	87
     13 	90
     13 	62
     13 	489
     12 	666
     12 	307
     12 	168
     11 	142
     10 	556
     10 	542
     10 	540
     10 	528
     10 	485
     10 	476
     10 	332
     10 	330
     10 	154
     10 	107
      9 	284
      9 	248
      8 	816
      8 	75
      8 	68
      7 	328
      7 	149
      7 	125
      6 	76
      6 	69
      6 	610
      6 	350
      6 	333
      6 	282
      6 	264
      6 	1034
      5 	88
      5 	817
      5 	628
      5 	613
      5 	329
      4 	89
      4 	85
      4 	79
      4 	65
      4 	346
      4 	345
      4 	322
      4 	267
      4 	254
      4 	244
      4 	177
      4 	170
      4 	124
      4 	106
      4 	1035
      3 	70
      3 	497
      3 	344
      3 	298
      3 	269
      3 	247
      3 	233
      2 	95
      2 	94
      2 	93
      2 	77
      2 	704
      2 	636
      2 	630
      2 	624
      2 	621
      2 	615
      2 	614
      2 	612
      2 	611
      2 	607
      2 	598
      2 	593
      2 	590
      2 	550
      2 	546
      2 	502
      2 	478
      2 	418
      2 	383
      2 	321
      2 	310
      2 	309
      2 	305
      2 	294
      2 	288
      2 	268
      2 	266
      2 	265
      2 	261
      2 	257
      2 	255
      2 	252
      2 	236
      2 	229
      2 	220
      2 	208
      2 	184
      2 	129
      2 	1212
      2 	111
      2 	105
      1 	979
      1 	952
      1 	926
      1 	760
      1 	752
      1 	746
      1 	730
      1 	72
      1 	694
      1 	690
      1 	679
      1 	678
      1 	640
      1 	608
      1 	601
      1 	596
      1 	592
      1 	588
      1 	568
      1 	552
      1 	548
      1 	544
      1 	54
      1 	535
      1 	518
      1 	506
      1 	482
      1 	479
      1 	446
      1 	433
      1 	432
      1 	429
      1 	428
      1 	417
      1 	412
      1 	396
      1 	389
      1 	374
      1 	372
      1 	347
      1 	335
      1 	320
      1 	317
      1 	312
      1 	308
      1 	306
      1 	223
      1 	207
      1 	195
      1 	178
      1 	171
      1 	156
      1 	1469
      1 	144
      1 	1218
      1 	1179
      1 	1170
      1 	1162
      1 	1102	 